// reference : https://blog.tensorflow.org/2020/08/introducing-danfo-js-pandas-like-library-in-javascript.html
// Below we show a simple end-to-end classification task using Danfo.js and TensorFlow.js. 
// We use Danfo for data loading, manipulating and preprocessing of the dataset, and then export the tensor object.

const dfd = require("danfojs-node")
const tf = require("@tensorflow/tfjs-node")

async function load_process_data() {
    let df = await dfd.read_csv("https://web.stanford.edu/class/archive/cs/cs109/cs109.1166/stuff/titanic.csv")

    df.print();
// ╔════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╗
// ║    │ Survived          │ Pclass            │ Name              │ Sex               │ ...               │ Age               │ Siblings/Spou...  │ Parents/Child...  │ Fare              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 0  │ 0                 │ 3                 │ Mr. Owen Harr...  │ male              │ ...               │ 22                │ 1                 │ 0                 │ 7.25              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 1  │ 1                 │ 1                 │ Mrs. John Bra...  │ female            │ ...               │ 38                │ 1                 │ 0                 │ 71.2833           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 2  │ 1                 │ 3                 │ Miss. Laina H...  │ female            │ ...               │ 26                │ 0                 │ 0                 │ 7.925             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 3  │ 1                 │ 1                 │ Mrs. Jacques ...  │ female            │ ...               │ 35                │ 1                 │ 0                 │ 53.1              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 4  │ 0                 │ 3                 │ Mr. William H...  │ male              │ ...               │ 35                │ 0                 │ 0                 │ 8.05              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 5  │ 0                 │ 3                 │ Mr. James Moran   │ male              │ ...               │ 27                │ 0                 │ 0                 │ 8.4583            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 6  │ 0                 │ 1                 │ Mr. Timothy J...  │ male              │ ...               │ 54                │ 0                 │ 0                 │ 51.8625           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 7  │ 0                 │ 3                 │ Master. Gosta...  │ male              │ ...               │ 2                 │ 3                 │ 1                 │ 21.075            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 8  │ 1                 │ 3                 │ Mrs. Oscar W ...  │ female            │ ...               │ 27                │ 0                 │ 2                 │ 11.1333           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 9  │ 1                 │ 2                 │ Mrs. Nicholas...  │ female            │ ...               │ 14                │ 1                 │ 0                 │ 30.0708           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 10 │ 1                 │ 3                 │ Miss. Marguer...  │ female            │ ...               │ 4                 │ 1                 │ 1                 │ 16.7              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 11 │ 1                 │ 1                 │ Miss. Elizabe...  │ female            │ ...               │ 58                │ 0                 │ 0                 │ 26.55             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 12 │ 0                 │ 3                 │ Mr. William H...  │ male              │ ...               │ 20                │ 0                 │ 0                 │ 8.05              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 13 │ 0                 │ 3                 │ Mr. Anders Jo...  │ male              │ ...               │ 39                │ 1                 │ 5                 │ 31.275            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 14 │ 0                 │ 3                 │ Miss. Hulda A...  │ female            │ ...               │ 14                │ 0                 │ 0                 │ 7.8542            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 15 │ 1                 │ 2                 │ Mrs. (Mary D ...  │ female            │ ...               │ 55                │ 0                 │ 0                 │ 16                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 16 │ 0                 │ 3                 │ Master. Eugen...  │ male              │ ...               │ 2                 │ 4                 │ 1                 │ 29.125            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 17 │ 1                 │ 2                 │ Mr. Charles E...  │ male              │ ...               │ 23                │ 0                 │ 0                 │ 13                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 18 │ 0                 │ 3                 │ Mrs. Julius (...  │ female            │ ...               │ 31                │ 1                 │ 0                 │ 18                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 19 │ 1                 │ 3                 │ Mrs. Fatima M...  │ female            │ ...               │ 22                │ 0                 │ 0                 │ 7.225             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 20 │ 0                 │ 2                 │ Mr. Joseph J ...  │ male              │ ...               │ 35                │ 0                 │ 0                 │ 26                ║
// ╚════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╝

    //A feature engineering: Extract all titles from names columns
    let title = df['Name'].apply((x) => { return x.split(".")[0] }).values
    //replace in df
    df.addColumn({ column: "Name", value: title })

    df.print();
// ╔════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╗
// ║    │ Survived          │ Pclass            │ Name              │ Sex               │ ...               │ Age               │ Siblings/Spou...  │ Parents/Child...  │ Fare              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 0  │ 0                 │ 3                 │ Mr                │ male              │ ...               │ 22                │ 1                 │ 0                 │ 7.25              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 1  │ 1                 │ 1                 │ Mrs               │ female            │ ...               │ 38                │ 1                 │ 0                 │ 71.2833           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 2  │ 1                 │ 3                 │ Miss              │ female            │ ...               │ 26                │ 0                 │ 0                 │ 7.925             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 3  │ 1                 │ 1                 │ Mrs               │ female            │ ...               │ 35                │ 1                 │ 0                 │ 53.1              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 4  │ 0                 │ 3                 │ Mr                │ male              │ ...               │ 35                │ 0                 │ 0                 │ 8.05              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 5  │ 0                 │ 3                 │ Mr                │ male              │ ...               │ 27                │ 0                 │ 0                 │ 8.4583            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 6  │ 0                 │ 1                 │ Mr                │ male              │ ...               │ 54                │ 0                 │ 0                 │ 51.8625           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 7  │ 0                 │ 3                 │ Master            │ male              │ ...               │ 2                 │ 3                 │ 1                 │ 21.075            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 8  │ 1                 │ 3                 │ Mrs               │ female            │ ...               │ 27                │ 0                 │ 2                 │ 11.1333           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 9  │ 1                 │ 2                 │ Mrs               │ female            │ ...               │ 14                │ 1                 │ 0                 │ 30.0708           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 10 │ 1                 │ 3                 │ Miss              │ female            │ ...               │ 4                 │ 1                 │ 1                 │ 16.7              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 11 │ 1                 │ 1                 │ Miss              │ female            │ ...               │ 58                │ 0                 │ 0                 │ 26.55             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 12 │ 0                 │ 3                 │ Mr                │ male              │ ...               │ 20                │ 0                 │ 0                 │ 8.05              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 13 │ 0                 │ 3                 │ Mr                │ male              │ ...               │ 39                │ 1                 │ 5                 │ 31.275            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 14 │ 0                 │ 3                 │ Miss              │ female            │ ...               │ 14                │ 0                 │ 0                 │ 7.8542            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 15 │ 1                 │ 2                 │ Mrs               │ female            │ ...               │ 55                │ 0                 │ 0                 │ 16                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 16 │ 0                 │ 3                 │ Master            │ male              │ ...               │ 2                 │ 4                 │ 1                 │ 29.125            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 17 │ 1                 │ 2                 │ Mr                │ male              │ ...               │ 23                │ 0                 │ 0                 │ 13                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 18 │ 0                 │ 3                 │ Mrs               │ female            │ ...               │ 31                │ 1                 │ 0                 │ 18                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 19 │ 1                 │ 3                 │ Mrs               │ female            │ ...               │ 22                │ 0                 │ 0                 │ 7.225             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 20 │ 0                 │ 2                 │ Mr                │ male              │ ...               │ 35                │ 0                 │ 0                 │ 26                ║
// ╚════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╝

    //label Encode Name feature
    let encoder = new dfd.LabelEncoder()
    let cols = ["Sex", "Name"]
    cols.forEach(col => {
        encoder.fit(df[col])
        enc_val = encoder.transform(df[col])
        df.addColumn({ column: col, value: enc_val })
    })

    df.print();
// ╔════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╤═══════════════════╗
// ║    │ Survived          │ Pclass            │ Name              │ Sex               │ ...               │ Age               │ Siblings/Spou...  │ Parents/Child...  │ Fare              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 0  │ 0                 │ 3                 │ 0                 │ 0                 │ ...               │ 22                │ 1                 │ 0                 │ 7.25              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 1  │ 1                 │ 1                 │ 1                 │ 1                 │ ...               │ 38                │ 1                 │ 0                 │ 71.2833           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 2  │ 1                 │ 3                 │ 2                 │ 1                 │ ...               │ 26                │ 0                 │ 0                 │ 7.925             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 3  │ 1                 │ 1                 │ 1                 │ 1                 │ ...               │ 35                │ 1                 │ 0                 │ 53.1              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 4  │ 0                 │ 3                 │ 0                 │ 0                 │ ...               │ 35                │ 0                 │ 0                 │ 8.05              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 5  │ 0                 │ 3                 │ 0                 │ 0                 │ ...               │ 27                │ 0                 │ 0                 │ 8.4583            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 6  │ 0                 │ 1                 │ 0                 │ 0                 │ ...               │ 54                │ 0                 │ 0                 │ 51.8625           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 7  │ 0                 │ 3                 │ 3                 │ 0                 │ ...               │ 2                 │ 3                 │ 1                 │ 21.075            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 8  │ 1                 │ 3                 │ 1                 │ 1                 │ ...               │ 27                │ 0                 │ 2                 │ 11.1333           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 9  │ 1                 │ 2                 │ 1                 │ 1                 │ ...               │ 14                │ 1                 │ 0                 │ 30.0708           ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 10 │ 1                 │ 3                 │ 2                 │ 1                 │ ...               │ 4                 │ 1                 │ 1                 │ 16.7              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 11 │ 1                 │ 1                 │ 2                 │ 1                 │ ...               │ 58                │ 0                 │ 0                 │ 26.55             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 12 │ 0                 │ 3                 │ 0                 │ 0                 │ ...               │ 20                │ 0                 │ 0                 │ 8.05              ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 13 │ 0                 │ 3                 │ 0                 │ 0                 │ ...               │ 39                │ 1                 │ 5                 │ 31.275            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 14 │ 0                 │ 3                 │ 2                 │ 1                 │ ...               │ 14                │ 0                 │ 0                 │ 7.8542            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 15 │ 1                 │ 2                 │ 1                 │ 1                 │ ...               │ 55                │ 0                 │ 0                 │ 16                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 16 │ 0                 │ 3                 │ 3                 │ 0                 │ ...               │ 2                 │ 4                 │ 1                 │ 29.125            ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 17 │ 1                 │ 2                 │ 0                 │ 0                 │ ...               │ 23                │ 0                 │ 0                 │ 13                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 18 │ 0                 │ 3                 │ 1                 │ 1                 │ ...               │ 31                │ 1                 │ 0                 │ 18                ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 19 │ 1                 │ 3                 │ 1                 │ 1                 │ ...               │ 22                │ 0                 │ 0                 │ 7.225             ║
// ╟────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────┼───────────────────╢
// ║ 20 │ 0                 │ 2                 │ 0                 │ 0                 │ ...               │ 35                │ 0                 │ 0                 │ 26                ║
// ╚════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╧═══════════════════╝

    let Xtrain,ytrain;
    Xtrain = df.iloc({ columns: [`1:`] })
    ytrain = df['Survived']

    // Standardize the data with MinMaxScaler
    let scaler = new dfd.MinMaxScaler()
    scaler.fit(Xtrain)
    Xtrain = scaler.transform(Xtrain);
   
    console.log(Xtrain.tensor);
    // Tensor {
    //     kept: false,
    //     isDisposedInternal: false,
    //     shape: [ 887, 7 ],
    //     dtype: 'float32',
    //     size: 6209,
    //     strides: [ 7 ],
    //     dataId: {},
    //     id: 126,
    //     rankType: '2'
    //   }
    Xtrain.tensor.print()
    // Tensor
    // [[1  , 0     , 0, 0.2711737, 0.125, 0        , 0.0141511],
    //  [0  , 0.0625, 1, 0.4722292, 0.125, 0        , 0.1391357],
    //  [1  , 0.125 , 1, 0.3214375, 0    , 0        , 0.0154686],
    //  ...,
    //  [1  , 0.125 , 1, 0.0826841, 0.125, 0.3333333, 0.0457713],
    //  [0  , 0     , 0, 0.3214375, 0    , 0        , 0.0585561],
    //  [1  , 0     , 0, 0.3968334, 0    , 0        , 0.015127 ]]
    ytrain.tensor.print();
    // Tensor
    // [0, 1, 1, ..., 0, 1, 0]

    return [Xtrain.tensor, ytrain.tensor] //return the data as tensors
}

// a simple neural network using TensorFlow.js.
function get_model() {
    const model = tf.sequential();
    model.add(tf.layers.dense({ inputShape: [7], units: 124, activation: 'relu', kernelInitializer: 'leCunNormal' }));
    model.add(tf.layers.dense({ units: 64, activation: 'relu' }));
    model.add(tf.layers.dense({ units: 32, activation: 'relu' }));
    model.add(tf.layers.dense({ units: 1, activation: "sigmoid" }))
    model.summary();
//     _________________________________________________________________
// Layer (type)                 Output shape              Param #   
// =================================================================
// dense_Dense1 (Dense)         [null,124]                992       
// _________________________________________________________________
// dense_Dense2 (Dense)         [null,64]                 8000      
// _________________________________________________________________
// dense_Dense3 (Dense)         [null,32]                 2080      
// _________________________________________________________________
// dense_Dense4 (Dense)         [null,1]                  33        
// =================================================================
// Total params: 11105
// Trainable params: 11105
// Non-trainable params: 0
    return model
}

// training, by first loading the model and the processed data as tensors. This can be fed directly to the neural network.
async function train() {
    const model = await get_model()
    const data = await load_process_data()
    const Xtrain = data[0]
    const ytrain = data[1]

    model.compile({
        optimizer: "rmsprop",  // Root Mean Squared
        loss: 'binaryCrossentropy',
        metrics: ['accuracy'],
    });

    console.log("Training started....")
    await model.fit(Xtrain, ytrain,{
        batchSize: 32,
        epochs: 6,
        validationSplit: 0.2,
        callbacks:{
            onEpochEnd: async(epoch, logs)=>{
                console.log(`EPOCH (${epoch + 1}): Train Accuracy: ${(logs.acc * 100).toFixed(2)},
                                                     Val Accuracy:  ${(logs.val_acc * 100).toFixed(2)}\n`);
            }
        }
    });
};

train();
// Training started....
// Epoch 1 / 6
// eta=0.0 ============================================================================================================> 
// 334ms 470us/step - acc=0.760 loss=0.535 val_acc=0.809 val_loss=0.446 
// EPOCH (1): Train Accuracy: 76.02,
//                                                      Val Accuracy:  80.90

// Epoch 2 / 6
// eta=0.0 ============================================================================================================> 
// 235ms 331us/step - acc=0.795 loss=0.472 val_acc=0.820 val_loss=0.415 
// EPOCH (2): Train Accuracy: 79.55,
//                                                      Val Accuracy:  82.02

// Epoch 3 / 6
// eta=0.0 ============================================================================================================> 
// 220ms 310us/step - acc=0.798 loss=0.454 val_acc=0.809 val_loss=0.413 
// EPOCH (3): Train Accuracy: 79.83,
//                                                      Val Accuracy:  80.90

// Epoch 4 / 6
// eta=0.0 ============================================================================================================> 
// 219ms 309us/step - acc=0.791 loss=0.452 val_acc=0.831 val_loss=0.403 
// EPOCH (4): Train Accuracy: 79.13,
//                                                      Val Accuracy:  83.15

// Epoch 5 / 6
// eta=0.0 ============================================================================================================> 
// 210ms 296us/step - acc=0.803 loss=0.447 val_acc=0.826 val_loss=0.403 
// EPOCH (5): Train Accuracy: 80.25,
//                                                      Val Accuracy:  82.58

// Epoch 6 / 6
// eta=0.0 ============================================================================================================> 
// 208ms 293us/step - acc=0.798 loss=0.444 val_acc=0.815 val_loss=0.396 
// EPOCH (6): Train Accuracy: 79.83,
//                                                      Val Accuracy:  81.46